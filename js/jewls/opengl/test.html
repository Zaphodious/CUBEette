<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
    </head>
    <body>
        <canvas id="c" height=600 width=600 style="width: 600px; height: 600px;">no canvas fo you</canvas>
        <script type="module">
            import * as gl from "./opengl.js";

            let c = document.getElementById("c");
            render(c);

            async function render(c) {
                await gl.initContext(c);

                let i1 = await loadImage('testimg.png');
                let i2 = await loadImage('testimg2.png');

                gl.createImageTexture("t1", i1);
                gl.createImageTexture("t2", i2);

                gl.createActor("a1", "t1");
                gl.createActor("a2", "t2", i2.width / 2, i2.height / 2);

                gl.setActorSprite("a2", 1, 0);

                gl.translateActor("a1", 0, 0);
                gl.translateActor("a2", -8200, 0);

                gl.createCamera("cam1", c.width, i2.height, 0, 0, 0, 0);
                gl.createCameraView("view1", "cam1");

                gl.translateCamera("cam1", -8000, 0);

                let i = 0;
                while (true) {
                    gl.rotateActor("a1", 360-i)
                    gl.rotateActor("a2", i);
                    gl.render(1, 0, 0, 1);
                    return;

                    ++i;
                    if (i === 360) i = 0;
                    await sleep(5);
                }
            }

            function sleep(time) {
                return new Promise((resolve, reject) => {
                    setTimeout(() => resolve(), time);
                })
            }

            function loadImage(url) {
                return new Promise((resolve, reject) => {
                    let i = new Image();
                    i.onload = () => resolve(i);
                    i.src = url;
                })
            }
        </script>
    </body>
</html>
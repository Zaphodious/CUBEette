<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
    </head>
    <body>
        <canvas id="c" height=600 width=600 style="width: 600px; height: 600px;">no canvas fo you</canvas>
        <script type="module">
            import * as gl from "./opengl.js";

            let c = document.getElementById("c");
            render(c);

            async function render(c) {
                await gl.initContext(c);
                
                //console.time('tileMap');
                let i1 = await loadImage('/carts/krackedEC/santasprites.png');

                gl.createImageTexture('i1', i1);

                let b = await fetch('/carts/krackedEC/testing.json');
                let j = await b.json();

                gl.createTileMap('tm1', 'i1', 8, 2, 16, 16, 9, [[1,2,3,4]]);
                //console.timeEnd('tileMap');
                //gl.scaleActor('tm1', .25, .25)

                gl.translateActor('tm1', c.width / 2, c.height / 2);

                for(let i = 0; i < 10; i++){
                    //console.time('render');
                    gl.render(1,1,1,1);
                    //console.timeEnd('render');
                    await sleep(5);
                }
            }

            function sleep(time) {
                return new Promise((resolve, reject) => {
                    setTimeout(() => resolve(), time);
                })
            }

            function loadImage(url) {
                return new Promise((resolve, reject) => {
                    let i = new Image();
                    i.onload = () => resolve(i);
                    i.src = url;
                })
            }
        </script>
    </body>
</html>